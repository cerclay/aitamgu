# Use Case Document

---

## 1. Actor Definitions

| 액터(Actor)    | 정의                                                                               |
|----------------|------------------------------------------------------------------------------------|
| **일반 사용자** | 웹 페이지에 접속하여 유명인 목록 및 추천 도서를 열람하고 필터/검색 기능을 사용하는 주체 |
| **시스템**      | 메인 페이지, 유명인 상세 페이지, 필터/검색 기능 등을 제공하고 데이터를 출력하는 웹 서비스 |

---

## 2. Use Case Scenarios

본 서비스에서 발생할 주요 시나리오는 다음과 같습니다:

1. **[UC01] 메인 페이지 접속 및 유명인 목록 열람**  
   - 사용자가 웹사이트에 접속하여 메인 페이지를 확인하고, 유명인 목록을 본다.

2. **[UC02] 유명인 상세 페이지 열람**  
   - 사용자가 특정 유명인을 선택하여 상세 프로필 및 추천 도서 목록을 조회한다.

3. **[UC03] 필터/검색 기능 사용**  
   - 사용자가 분야별(기업가, 연예인, 스포츠 선수 등) 필터와 검색(책/저자/유명인 이름) 기능을 통해 원하는 정보를 찾는다.

---

## 3. Main Steps

아래는 각 Use Case의 간략한 주요 단계(Main Steps)를 정리한 표입니다:

| Use Case | 주요 단계                                                                                 |
|----------|-------------------------------------------------------------------------------------------|
| UC01     | 1) 사용자가 웹사이트에 접속 <br> 2) 시스템이 메인 페이지와 유명인 목록을 로드 <br> 3) 사용자에게 목록이 표시됨 |
| UC02     | 1) 사용자가 특정 유명인을 선택 <br> 2) 시스템이 해당 유명인 상세 정보 및 추천 도서 목록을 불러옴 <br> 3) 사용자에게 상세 내용이 표시됨 |
| UC03     | 1) 사용자가 필터 또는 검색 키워드를 입력 <br> 2) 시스템이 조건에 맞는 유명인 또는 도서를 검색 <br> 3) 사용자에게 결과 목록이 표시됨 |

---

## 4. Exception Handling

- **네트워크 오류**:  
  - 메인 페이지 혹은 유명인 상세 페이지 요청 시 네트워크 불안정으로 데이터를 불러오지 못하면, 사용자에게 “네트워크 오류” 메시지 표시.
- **데이터가 없는 경우**:  
  - 해당 필터나 검색 결과에 맞는 도서/유명인이 없으면 “검색 결과 없음” 메시지 표시.
- **잘못된 URL 접근**:  
  - `/celebrity/[slug]` 경로에 잘못된 slug가 들어오면 404 페이지 혹은 “존재하지 않는 페이지” 안내.

---

## 5. Comprehensive Actor Definitions

### 일반 사용자
- **목적**: 유명인의 추천 도서를 쉽고 빠르게 찾기
- **행동 패턴**:
  1. 메인 페이지에서 유명인 목록을 훑어보며 흥미로운 인물 탐색  
  2. 특정 인물의 상세 정보와 추천 도서를 더 자세히 확인  
  3. 분야별(기업가/연예인/스포츠 선수 등)로 필터하거나 검색으로 특정 도서나 유명인을 찾음  
- **기술적 이해도**: 웹 브라우저를 사용할 줄 알며, 추가 인증/로그인 절차는 없음

### 시스템
- **목적**: 사용자 요청에 맞는 데이터를 빠르고 정확하게 전달
- **주요 기능**:
  1. 데이터베이스 연결(Supabase)  
  2. 메인 페이지/유명인 상세 페이지 렌더링(Next.js)  
  3. 필터/검색 결과 반환  
- **한계**: 네트워크 문제 발생 시 안정적으로 동작하기 어려움, 데이터베이스 장애 시 응답 불가

---

## 6. Detailed Use Case Scenarios

### [UC01] 메인 페이지 접속 및 유명인 목록 열람

**시나리오 상세**  
1. 사용자는 브라우저에서 서비스 URL에 접속한다.  
2. 시스템은 메인 페이지 레이아웃(Topbar, Footer 등)과 함께 유명인 목록 데이터를 Supabase에서 조회한다.  
3. 시스템은 조회한 유명인 목록(프로필 사진, 이름, 분야, 추천 도서 수 등)을 사용자 화면에 표시한다.  
4. 사용자는 스크롤 등을 통해 카드 형식으로 표시된 유명인 목록을 탐색한다.

**예외 시나리오**  
- **네트워크 장애**: 데이터 로드 실패 시 “네트워크 오류가 발생했습니다” 메시지 표시.

### [UC02] 유명인 상세 페이지 열람

**시나리오 상세**  
1. 사용자(예: 김철수)가 특정 유명인(예: 빌 게이츠)의 카드를 클릭한다.  
2. 시스템은 URL `/celebrity/bill-gates` 형태로 라우팅하여 해당 유명인 정보를 로딩한다.  
3. Supabase에서 `bill-gates`에 해당하는 프로필, 추천 도서 목록 등의 데이터를 조회한다.  
4. 시스템은 해당 데이터를 페이지에 렌더링 후, 사용자에게 표시한다.  
5. 사용자는 도서 목록을 살펴보고, 마음에 드는 도서를 클릭해 추가 정보를 확인하거나 외부 서점 링크로 이동할 수 있다(선택 사항).

**예외 시나리오**  
- **유효하지 않은 slug**: `/celebrity/unknown-artist`와 같이 존재하지 않는 인물이 들어오면 404 메시지를 표시한다.  

### [UC03] 필터/검색 기능 사용

**시나리오 상세**  
1. 사용자(박민지)가 상단바 또는 메인 페이지 필터에서 “연예인”을 선택한다.  
2. 시스템은 데이터베이스에서 `분야=연예인`에 해당하는 유명인만 검색하여 목록을 재구성한다.  
3. 검색 결과가 화면에 표시되며, 필터 선택 시 동적인 목록 갱신(클라이언트 사이드 Fetch)으로 반영된다.  
4. 사용자가 검색창에 “소설” 키워드를 입력하고 엔터를 누른다.  
5. 시스템은 “소설”을 검색어로 인덱스 조회 후, 관련 도서를 추천한 유명인을 반환한다.  
6. 검색 결과 목록이 갱신되어 사용자에게 표시된다.

**예외 시나리오**  
- **검색 결과 없음**: “조건에 맞는 유명인이나 추천 도서가 없습니다” 메시지 표시  

---

## 7. Main Steps and Flow of Events

아래는 UC01, UC02, UC03 각각의 흐름을 더욱 명확히 표현한 예시입니다:

1. **UC01 - 메인 페이지 접속**  
   - **프론트엔드**: `/` 경로 요청  
   - **백엔드**: Supabase API 호출 → 유명인 리스트 조회  
   - **프론트엔드**: 유명인 카드 목록 그리드로 렌더링  
   - **사용자**: 목록 열람  

2. **UC02 - 유명인 상세 페이지**  
   - **사용자**: 특정 유명인 카드 클릭  
   - **프론트엔드**: `/celebrity/[slug]` 경로 요청  
   - **백엔드**: 해당 slug(유명인 ID)에 해당하는 상세 프로필 및 추천 도서 데이터 조회  
   - **프론트엔드**: 페이지 렌더링 후 표시  

3. **UC03 - 필터/검색 사용**  
   - **사용자**: 원하는 필터(예: “기업가”) 또는 검색어(“소설”) 입력  
   - **프론트엔드**: AJAX/CSR 방식으로 Supabase에 조건부 쿼리  
   - **백엔드**: 조건에 부합하는 결과 집합 반환  
   - **프론트엔드**: 필터/검색 결과를 동적으로 렌더링

---

## 8. Alternative Flows and Edge Cases

| 상황                           | 대응 방안                                                                                      |
|--------------------------------|-----------------------------------------------------------------------------------------------|
| **네트워크 지연 또는 불안정**    | 로딩 스피너(Loading Indicator) 표시, 일정 시간 초과 시 에러 메시지 출력                          |
| **검색어에 특수문자 포함**       | 클라이언트에서 특수문자 이스케이프 처리 후 서버로 전달                                          |
| **필터+검색 조합**              | 예: “연예인” 필터 적용 후 “소설” 검색 → 시스템은 AND 조건으로 검색 결과 반환                     |
| **비정상 slug 접근**            | 존재하지 않는 slug일 경우 404 페이지 또는 “존재하지 않는 유명인” 안내 팝업                       |
| **데이터베이스 장애**           | “서비스 점검 중” 메시지 표시, 장애 복구 이후 재시도                                             |
| **이미지 로드 실패**            | 기본 대체 이미지나 ‘이미지 로드 실패’ 안내 텍스트로 대체 렌더링                                 |

---

## 9. Preconditions and Postconditions

### 공통 사전 조건 (Preconditions)
1. 사용자가 인터넷 브라우저를 통해 서비스에 접속 가능한 상태여야 함.  
2. Supabase 데이터베이스가 정상 작동 중이어야 함.

### 공통 사후 조건 (Postconditions)
1. 사용자 요청에 대한 응답(유명인 목록, 검색 결과 등)이 화면에 정상적으로 표시됨.  
2. 예외 발생 시, 적절한 에러 메시지 또는 상태 페이지가 표시됨.

---

## 10. Business Rules and Constraints

1. **무결성**: 유명인 데이터(이름, 분야, 추천 도서)가 명확하고 중복 없이 관리되어야 함.  
2. **분류 체계**: 기업가, 연예인, 스포츠 선수 등 **주요 분야**가 데이터베이스에 정규화되어 있어야 함.  
3. **저작권**: 추천 도서 표지 및 소개글 사용 시, 해당 도서 정보 제공이 합법 범위 내에서 이뤄져야 함.  
4. **확장성**: 장르/분야 추가, 추천 도서 수 증가 등 확장 요구사항이 있을 수 있음.  
5. **성능**: 사용자 트래픽 급증 시에도 검색, 필터 기능이 원활히 동작해야 함.

---

## 11. Exception Handling Procedures

1. **오류 감지**:  
   - 프론트엔드: 요청 실패 시 catch 블록에서 예외 핸들링  
   - 백엔드: DB 접속 장애 시 예외 반환
2. **오류 메시지 처리**:  
   - 사용자 화면에 오류 상황을 짧고 명확한 한국어 문구로 표시  
   - 예: “죄송합니다. 현재 데이터를 불러올 수 없습니다.”
3. **재시도 로직** (선택사항):  
   - 네트워크 일시 장애 시 짧은 시간(수 초) 뒤 자동 재시도

---

## 12. User Interface Considerations

1. **반응형 디자인**  
   - 모바일: 유명인 카드가 1열로 표시, 필터/검색 기능은 상단 드로어 또는 아이콘 클릭 시 표시  
   - 데스크톱: 2~4열 그리드, 상단바에 필터와 검색 배치  
2. **접근성(A11y)**  
   - 텍스트에 충분한 대비도(Color Contrast) 확보  
   - 필터, 검색, 카드 등 주요 UI 요소에 `aria-label` 또는 스크린리더 친화적 속성 부여  
3. **가독성**  
   - 유명인 프로필, 추천 도서 요약은 간결한 문장으로 정리  
4. **SEO**  
   - 메인 페이지, 유명인 상세 페이지에서 메타 태그와 구조화 데이터(OG 태그 등) 설정

---

## 13. Data Requirements and Data Flow

- **데이터베이스**: Supabase (PostgreSQL 기반)
- **주요 엔터티**:  
  - `Celebrity`: `id`, `slug`, `이름`, `분야`, `프로필`, `사진URL` 등  
  - `Book`: `id`, `제목`, `저자`, `표지URL`, `추천사` 등  
  - `CelebrityBookMap`: 유명인과 도서 간 다대다 관계 관리
- **데이터 흐름**:  
  1. **메인 페이지 로드** → Supabase에서 `Celebrity` 목록 조회  
  2. **상세 페이지 요청** → `slug`로 특정 `Celebrity` 조회 후 `CelebrityBookMap`을 통해 추천 도서(`Book`) 목록 조회  
  3. **필터/검색** → 프론트엔드에서 조건을 전송 → Supabase에서 해당 조건에 맞는 `Celebrity` 혹은 `Book` 검색 결과 반환

---

## 14. Security and Privacy Considerations

1. **개인정보**: 현재 사용자에게서 수집되는 개인정보 없음(회원가입/로그인 미구현).  
2. **데이터 무결성**: 유명인 및 도서 정보에 대한 무결성 유지 필요.  
3. **HTTPS 사용 권장**: 전송 구간 암호화를 통해 데이터 스니핑 방지  
4. **CORS 설정**: API를 호출할 때 안전한 도메인에서만 접근하도록 설정 가능  
5. **에러 로깅**: 서버 에러, DB 에러, API 실패 등에 대한 적절한 로깅(개인정보가 없으므로 로그에 민감 정보 노출 위험은 낮음)

---

